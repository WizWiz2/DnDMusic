# üéµ –¢–ó: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º—É–∑—ã–∫–∞ –ø–æ–¥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–ª—è —Ä–æ–ª–µ–≤—ã—Ö –∏–≥—Ä (—Å –∂–∞–Ω—Ä–∞–º–∏)

## üîÆ –ò–¥–µ—è
–°–µ—Ä–≤–∏—Å —Å–ª—É—à–∞–µ—Ç —Ä–µ—á—å –∑–∞ –∏–≥—Ä–æ–≤—ã–º —Å—Ç–æ–ª–æ–º (–æ–Ω–ª–∞–π–Ω/–æ—Ñ—Ñ–ª–∞–π–Ω), —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —Ç–µ–∫—Å—Ç, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç ¬´—Å—Ü–µ–Ω—É¬ª (–±–æ–π, —Ç–∞–≤–µ—Ä–Ω–∞, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, –æ—Ç–¥—ã—Ö) **–∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∂–∞–Ω—Ä –∏–≥—Ä—ã** (—Ñ—ç–Ω—Ç–µ–∑–∏, –∫–∏–±–µ—Ä–ø–∞–Ω–∫, sci-fi, —Ö–æ—Ä—Ä–æ—Ä).  
–î–∞–ª—å—à–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â—É—é –º—É–∑—ã–∫—É –∏–∑ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –§—Ä–æ–Ω—Ç–µ–Ω–¥ (–±—Ä–∞—É–∑–µ—Ä, PWA)
- –î–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É —á–µ—Ä–µ–∑ `getUserMedia`.
- –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è —Ä–µ—á–∏ –ª–æ–∫–∞–ª—å–Ω–æ (–±–µ–∑ API-–∑–∞—Ç—Ä–∞—Ç):  
  - **whisper.cpp (WASM)** –∏–ª–∏ **xenova/whisper-webgpu**.
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å—Ü–µ–Ω—ã:  
  - v1: –ø—Ä–∞–≤–∏–ª–∞/–∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞;  
  - v2: –ª—ë–≥–∫–∞—è LLM (WebGPU).
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞—ë—Ç **–∂–∞–Ω—Ä –∏–≥—Ä—ã** (Fantasy, Cyberpunk, Sci-fi, Horror).  
- –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º—É–∑—ã–∫–∏ –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:  
  - **YouTube IFrame API**,  
  - **Pixabay Music / Free Music Archive / Jamendo**,  
  - **Audius**,  
  - –∏–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ MP3/OGG-—Ñ–∞–π–ª—ã –Ω–∞ GitHub Pages/Cloudflare.  
- –õ–æ–≥–∏–∫–∞ ¬´–∞–Ω—Ç–∏–¥—Ä–µ–±–µ–∑–≥–∞¬ª: –æ–∫–Ω–æ 30‚Äì45 —Å, cooldown 60‚Äì90 —Å, –∫—Ä–æ—Å—Å—Ñ–µ–π–¥ –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç—Ä–µ–∫–∞.

### –ë—ç–∫–µ–Ω–¥ (Railway, –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ)
- –¢–æ–Ω–∫–∏–π API:  
  - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–≥ —Å—Ü–µ–Ω—ã –∏ –∂–∞–Ω—Ä ‚Üí –∏—â–µ—Ç —Ç—Ä–µ–∫–∏ –≤ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö.  
  - –ö—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (Redis/in-memory) –Ω–∞ 10‚Äì30 –º–∏–Ω—É—Ç.  
  - –û—Ç–¥–∞—ë—Ç —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É.
- –ù–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –º—É–∑—ã–∫—É, —Ç–æ–ª—å–∫–æ –ø–æ–∏—Å–∫ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ.

---

## ‚öôÔ∏è –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã
1. –ú–∏–∫—Ä–æ—Ñ–æ–Ω ‚Üí —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è (Whisper).  
2. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ ‚Üí —Ç–µ–≥ —Å—Ü–µ–Ω—ã.  
3. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∂–∞–Ω—Ä.  
4. –û—Ç–ø—Ä–∞–≤–∫–∞ `scene+genre` –Ω–∞ Railway API.  
5. API –∏—â–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ç—Ä–µ–∫–æ–≤ (YouTube/Audio/MP3).  
6. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤–∫–ª—é—á–∞–µ—Ç –ø–µ—Ä–≤—ã–π –ø–æ–¥—Ö–æ–¥—è—â–∏–π (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥–ª–∏–Ω—ã/–∫–∞—á–µ—Å—Ç–≤–∞).  
7. –ê–Ω—Ç–∏–¥—Ä–µ–±–µ–∑–≥ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —á–∞—Å—Ç–æ—Ç—É —Å–º–µ–Ω—ã —Ç—Ä–µ–∫–æ–≤.  
8. –ü—Ä–∏ —Å–º–µ–Ω–µ —Å—Ü–µ–Ω—ã –º—É–∑—ã–∫–∞ –ø–ª–∞–≤–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è (–∫—Ä–æ—Å—Å—Ñ–µ–π–¥, –≥—Ä–æ–º–∫–æ—Å—Ç—å).  

---

## üîë –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ —Å—Ü–µ–Ω–∞–º –∏ –∂–∞–Ω—Ä–∞–º

### Fantasy
- **Battle**: `epic fantasy battle instrumental -vocals`  
- **Tavern**: `medieval tavern lute folk instrumental -vocals`  
- **Exploration**: `fantasy dungeon forest ambient instrumental -vocals`  

### Cyberpunk
- **Battle**: `cyberpunk combat synthwave instrumental -vocals`  
- **Tavern/Bar**: `cyberpunk bar neon synth lounge instrumental -vocals`  
- **Exploration**: `cyberpunk city ambient neon instrumental -vocals`  

### Sci-fi
- **Battle**: `space opera battle orchestral instrumental -vocals`  
- **Exploration**: `sci fi ambient exploration instrumental -vocals`  

### Horror
- **Tension**: `dark horror suspense ambient drone instrumental -vocals`  
- **Exploration**: `creepy dungeon ambient instrumental -vocals`  

–§–∏–ª—å—Ç—Ä—ã:  
- –ú–∏–Ω. –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 90 —Å–µ–∫, –º–∞–∫—Å. 10 –º–∏–Ω.  
- –ò—Å–∫–ª—é—á–∏—Ç—å `-vocals -lyrics -cover -live`.  

---

## üéõ –ö–æ–Ω—Ñ–∏–≥ (–ø—Ä–∏–º–µ—Ä YAML)
```yaml
genres:
  fantasy:
    BATTLE:
      query: "epic fantasy battle instrumental -vocals"
      volume: 85
      crossfade: 3
    TAVERN:
      query: "medieval tavern lute instrumental -vocals"
      volume: 70
      crossfade: 5
  cyberpunk:
    BATTLE:
      query: "cyberpunk combat synthwave instrumental -vocals"
      volume: 85
      crossfade: 3
    TAVERN:
      query: "cyberpunk bar synth lounge instrumental -vocals"
      volume: 70
      crossfade: 5

hysteresis:
  min_confidence: 0.6
  window_sec: 30
  cooldown_sec: 75
```

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **–§—Ä–æ–Ω—Ç–µ–Ω–¥**: React/Vue/Next.js + Whisper WASM/WebGPU + YouTube IFrame API.  
- **–ë—ç–∫–µ–Ω–¥ (Railway)**: Node.js/Python (FastAPI/Express), API-–ø—Ä–æ–∫—Å–∏ –∫ YouTube/Pixabay/Jamendo.  
- **–ö—ç—à**: Redis (Railway free), –∏–ª–∏ in-memory store.  
- **–î–µ–ø–ª–æ–π**: Railway (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ).  

---

## üöÄ MVP (–∑–∞ –≤–µ—á–µ—Ä)
- –§—Ä–æ–Ω—Ç–µ–Ω–¥: –º–∏–∫—Ä–æ—Ñ–æ–Ω ‚Üí Whisper (tiny) ‚Üí –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ ‚Üí —Ç–µ–≥ —Å—Ü–µ–Ω—ã ‚Üí + –∂–∞–Ω—Ä ‚Üí –∑–∞–ø—Ä–æ—Å –≤ API ‚Üí –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ YouTube.  
- –ë—ç–∫–µ–Ω–¥: `/api/search?genre=fantasy&scene=Battle` ‚Üí —Å–ø–∏—Å–æ–∫ —Å—Å—ã–ª–æ–∫ YouTube.  
- –ê–Ω—Ç–∏–¥—Ä–µ–±–µ–∑–≥ + —Ä—É—á–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ override.

---

## üìå –£–ª—É—á—à–µ–Ω–∏—è
- –ñ—ë—Å—Ç–∫–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã: –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Å–≤–∏—Ç—á –ø–æ —Å–ª–æ–≤–∞–º ¬´–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞¬ª, ¬´–∞—Ç–∞–∫—É—é¬ª, ¬´–ª–æ–≤—É—à–∫–∞¬ª.  
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –º—É–∑—ã–∫–∏.  
- –û–±—É—á–∞–µ–º—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä (—Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —Å–µ—Ç—Ç–∏–Ω–≥ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º, –ø–æ–¥–±–∏—Ä–∞–µ—Ç –∂–∞–Ω—Ä —Å–∞–º).  
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Foundry/Discord (webhook ‚Üí —Ç–µ–≥ —Å—Ü–µ–Ω—ã).  
- PWA-—Ä–µ–∂–∏–º —Å –æ—Ñ—Ñ–ª–∞–π–Ω-–∫—ç—à–µ–º —Ç—Ä–µ–∫–æ–≤ –∏ –º–æ–¥–µ–ª–µ–π.
